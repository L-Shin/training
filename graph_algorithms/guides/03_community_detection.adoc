= Community Detection Algorithms
:icons: font
:csv-url: https://raw.githubusercontent.com/mathbeveridge/asoiaf/master/data

== Community Detection Algorithms

== Triangles

[source, cypher]
----
CALL algo.triangle.stream("Place","EROAD")
YIELD nodeA, nodeB, nodeC
RETURN algo.getNodeById(nodeA).name AS nodeA,
       algo.getNodeById(nodeB).name AS nodeB,
       algo.getNodeById(nodeC).name AS nodeC
----

== Local Clustering Coefficient

[source, cypher]
----
CALL algo.triangleCount.stream('Place', 'EROAD')
YIELD nodeId, triangles, coefficient
WHERE coefficient > 0
RETURN algo.getNodeById(nodeId).name AS place, coefficient
ORDER BY coefficient DESC
----

How is this score calculated?

[source, cypher]
----
MATCH (p1:Place {name: "Berlin"})-[:EROAD]-(neighbor)
WITH p1, collect(neighbor) AS neighbors
UNWIND neighbors AS node1
UNWIND neighbors AS node2
OPTIONAL MATCH neighborPath = (node1)-[:EROAD]-(node2)
OPTIONAL MATCH berlinPath = (node1)-[:EROAD]-(p1)-[:EROAD]-(node2)
RETURN neighborPath, berlinPath
----

== Connected Components

[source, cypher]
----
CALL algo.unionFind.stream("Place", "EROAD")
YIELD nodeId, setId
RETURN setId, collect(algo.getNodeById(nodeId).name) AS places
ORDER BY size(places) DESC
----


== Label Propagation

[source, cypher]
----
CALL algo.labelPropagation.stream("Place", "EROAD", { iterations: 10, direction: "BOTH" })
YIELD nodeId, label
RETURN label, collect(algo.getNodeById(nodeId).name) AS places
ORDER BY size(places) DESC
----
