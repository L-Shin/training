<style type="text/css" media="screen">
/*
.nodes-image {
	margin:-100;
}
*/	
@import url("//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css");

.imageblock .content img, .image img {max-width: 900px;max-height: 300px;}
.deck h3, .deck h4 {display: block !important;margin-bottom:8px;margin-top:5px;}
.listingblock {margin:8px;}
.pull-bottom {position:relative;bottom:1em;}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.admonitionblock.note.speaker { display:none; }
</style>
<style type="text/css" media="screen">
#editor.maximize-editor .CodeMirror-code { font-size:24px; line-height:26px; }
</style>
<article class="guide" ng-controller="AdLibDataController">
  <carousel class="deck container-fluid">
    <!--slide class="row-fluid">
      <div class="col-sm-3">
        <h3>Intro to The Flight Dataset</h3>
        <p class="lead">Information</p>
			<!dl>
				
				
				
				
				
			</dl>
		</div>
      <div class="col-sm-9">
        <figure>
          <img style="width:300px" src=""/>
        </figure>
      </div>
    </slide-->
    


<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Intro to The Flight Dataset</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>Welcome to the first of a set of interactive guides.
In these guides we&#8217;ll evolve a dataset containing the flights between US airports in 2008.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s get started!</p>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Start with a question</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>When modeling a dataset it always helps to have a use case in mind.
We&#8217;ll start with the following question:</p>
</div>
<div class="verseblock">
<pre class="content">As a plane enthusiast
I want to know how many flights there are between &lt;origin&gt; and &lt;destination&gt;
So that I can know how busy various airports are</pre>
</div>
<div class="paragraph">
<p>Let&#8217;s have a look what data we&#8217;ve got to help us answer this question:</p>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exploring data with <code>LOAD CSV</code></h3>
    <br/>
    <div>
      <div class="paragraph">
<p>As we saw from our brief command line exploration, we&#8217;ve got a lot of flights to work with.
We could use command line tools to explore this further but Cypher&#8217;s <code>LOAD CSV</code> command is actually perfect for exploring CSV files.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="http://localhost:8001/img/slides.jpg" alt="slides">
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exploring data with <code>LOAD CSV</code></h3>
    <br/>
    <div>
      <div class="paragraph">
<p>We can run the following query to see what data we&#8217;ve got to work with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->LOAD CSV WITH HEADERS FROM "file:///2008.csv" AS row
RETURN row
LIMIT 5<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p>This query:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>loads the file <code>2008.csv</code> from your <code>import</code> directory</p>
</li>
<li>
<p>iterates over the file, referring to each line as the variable <code>row</code></p>
</li>
<li>
<p>and returns the first 5 lines in the file</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We&#8217;ve got lots of different fields but the ones that will be helpful for answering our question are: <code>Origin</code>, <code>Dest</code>, and <code>FlightNum</code>.</p>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Modeling flights and airports</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>Before we use <code>LOAD CSV</code> to import any data we need to know what model we want to create.
The following should suffice:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="http://localhost:8001/img/initial.png" alt="initial" width="100%">
</div>
</div>
<div class="paragraph">
<p>We should do a quite primer here on the building blocks of the model.</p>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Importing flights and airports</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>While we&#8217;re working out the appropriate model for our dataset it&#8217;s much easier to work with a subset of the data so that we can iterate quickly.
We&#8217;ll work with the first 10,000 rows of the CSV file.</p>
</div>
<div class="paragraph">
<p>Run the following query to create nodes and relationships for these flights:</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->LOAD CSV WITH HEADERS FROM "file:///2008.csv" AS row
WITH row LIMIT 10000
MERGE (origin:Airport {code: row.Origin})
MERGE (destination:Airport {code: row.Dest})
MERGE (origin)-[flight:FLIGHT {airline: row.UniqueCarrier,
                               flightNumber: row.FlightNum,
                               year: TOINT(row.Year),
                               month: TOINT(row.Month),
                               day: TOINT(row.DayofMonth)}]-&gt;(destination)
ON CREATE SET flight.departure = TOINT(row.CRSDepTime), flight.arrival = TOINT(row.CRSArrTime)<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p>This query:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>takes the first 10,000 rows in the CSV file</p>
</li>
<li>
<p>creates nodes with the <code>Airport</code> label for the origin and destination airports if they don&#8217;t already exist</p>
</li>
<li>
<p>creates a <code>FLIGHT</code> relationship between origin and destination airports for each row in the file</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default properties will be stored as strings.
We know that <code>year</code>, <code>month</code>, and <code>day</code> are actually numeric values so we&#8217;ll coerce them using the <a href="/docs"><code>TOINT</code></a> function.</p>
</div>
<div class="paragraph">
<p>Now we&#8217;re ready to start querying the data.</p>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Finding the most popular airports</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>We can see some of what we&#8217;ve imported by writing the following query, which finds the airports with the most incoming and outgoing flights.</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH (a:Airport)
WITH a, SIZE((a)-[:FLIGHT]-&gt;()) AS outgoing, SIZE((a)&lt;-[:FLIGHT]-()) AS incoming
RETURN a.code, outgoing, incoming
ORDER BY outgoing DESC<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p>This query:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>finds every node with the <code>Airport</code> label</p>
</li>
<li>
<p>uses the <code>SIZE</code> function to count the number of incoming and outgoing relationship of type <code>FLIGHT</code> for each <code>Airport</code> node</p>
</li>
<li>
<p>returns the <code>code</code> property on the <code>Airport</code> nodes and the <code>outgoing</code> and <code>incoming</code> counts in descending order by <code>outgoing</code></p>
</li>
</ul>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise: Finding flights</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>Now it&#8217;s your turn!</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Find all the flights for flight number <code>WN 1016</code></p>
</li>
<li>
<p>Find all the flights in January 2008 that go to Las Vegas (<code>LAS</code>)</p>
</li>
</ul>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Answer: Find all the flights for flight number <code>WN 1016</code></h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH  (origin:Airport)-[flight:FLIGHT]-&gt;(destination:Airport)
WHERE flight.airline = "WN" AND flight.flightNumber = "1016"
RETURN origin.code, destination.code, flight.year, flight.month, flight.day, flight.departure, flight.arrival
ORDER BY flight.year, flight.month, flight.day, flight.departure<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Answer: Find all the flights that go to Las Vegas (<code>LAS</code>)</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH  (origin:Airport)-[flight:FLIGHT]-&gt;(destination:Airport)
WHERE destination.code = "LAS"
RETURN origin.code, destination.code, flight.year, flight.month, flight.day, flight.departure, flight.arrival
ORDER BY flight.year, flight.month, flight.day, flight.departure<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Next Step</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>In the next section we&#8217;re going to refactor the model to introduce <code>Flight</code> as a first class concept to make this type of query easier to write.</p>
</div>
<div class="paragraph">
<p><a play-topic='http://localhost:8001/02_flight.html'>Flight as a first class citizen</a></p>
</div>
	</div>
  </div>
</slide>
  </carousel>
</article>