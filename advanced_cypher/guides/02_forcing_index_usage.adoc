= Forcing queries to use indexes
:icons: font

== Forcing queries to use indexes

Let's import the full movies dataset

[source, cypher, subs=attributes]
----
LOAD CSV WITH HEADERS FROM '{csv-url}people.csv' as row

MERGE(person:Person {id: toInt(row.personId)})
ON CREATE SET person.name = row.name,
              person.born = toInt(row.birthYear),
              person.died = toInt(row.deathYear)
----

[source, cypher, subs=attributes]
----
LOAD CSV WITH HEADERS FROM '{csv-url}new_movies.csv' as row

MERGE (movie:Movie {id:toInt(row.movieId)})
ON CREATE SET
  movie.title = row.title,
  movie.avgVote = toFloat(row.avgVote),
  movie.releaseYear = toInt(row.releaseYear),
  movie.tagline = row.tagline,
  movie.genres = split(row.genres, ":")
----

[source, cypher, subs=attributes]
----
LOAD CSV WITH HEADERS FROM '{csv-url}directors.csv' as row

MATCH (movie:Movie {id:movieId})
MATCH (person:Person {id: personId})
MERGE (person)-[:DIRECTED]->(movie)
----

[source, cypher, subs=attributes]
----
LOAD CSV WITH HEADERS FROM '{csv-url}actors.csv' as row

MATCH (movie:Movie {id:toInt(row.movieId)})
MATCH (person:Person {id: toInt(row.personId)})

MERGE (person)-[actedIn:ACTED_IN]->(movie)
ON CREATE SET actedIn.roles = CASE WHEN row.characters IS NULL then [] ELSE split(row.characters, ":") END as roles
----

== Query time

Let's write some queries against the dataset now. 
